<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Lich::DragonRealms::DRCT
  
    &mdash; Lich 5 Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Lich::DragonRealms::DRCT";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Lich.html" title="Lich (module)">Lich</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DragonRealms.html" title="Lich::DragonRealms (module)">DragonRealms</a></span></span>
     &raquo; 
    <span class="title">DRCT</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Lich::DragonRealms::DRCT
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>documented/dragonrealms/commons/common-travel.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ask_for_item%3F-class_method" title="ask_for_item? (class method)">.<strong>ask_for_item?</strong>(room, name, item)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Visit a merchant and ask for an item.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#buy_item-class_method" title="buy_item (class method)">.<strong>buy_item</strong>(room, item)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Visit a merchant and buy an item by offering their asking price.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispose-class_method" title="dispose (class method)">.<strong>dispose</strong>(item, trash_room = nil, worn_trashcan = nil, worn_trashcan_verb = nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Dispose of an item in a trash can or designated area.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_empty_room-class_method" title="find_empty_room (class method)">.<strong>find_empty_room</strong>(search_rooms, idle_room, predicate = nil, min_mana = 0, strict_mana = false, max_search_attempts = Float::INFINITY, priotize_buddies = false)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find an empty room based on specified criteria.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_sorted_empty_room-class_method" title="find_sorted_empty_room (class method)">.<strong>find_sorted_empty_room</strong>(search_rooms, idle_room, predicate = nil)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Find an empty room from a sorted list of rooms.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_hometown_target_id-class_method" title="get_hometown_target_id (class method)">.<strong>get_hometown_target_id</strong>(hometown, target)  &#x21d2; Integer<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get the target ID for a specific target in a hometown.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#order_item-class_method" title="order_item (class method)">.<strong>order_item</strong>(room, item_number)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Visit a merchant and order from a menu.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#refill_lockpick_container-class_method" title="refill_lockpick_container (class method)">.<strong>refill_lockpick_container</strong>(lockpick_type, hometown, container, count)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Refill a lockpick container with a specified type of lockpick.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retreat-class_method" title="retreat (class method)">.<strong>retreat</strong>(ignored_npcs = [])  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retreat from a room, avoiding specified NPCs.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reverse_path-class_method" title="reverse_path (class method)">.<strong>reverse_path</strong>(path)  &#x21d2; Array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reverse a path of directions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sell_item-class_method" title="sell_item (class method)">.<strong>sell_item</strong>(room, item)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Visit a merchant and sell an item.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sort_destinations-class_method" title="sort_destinations (class method)">.<strong>sort_destinations</strong>(target_list)  &#x21d2; Array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sort a list of destinations based on distance from the current room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tag_to_id-class_method" title="tag_to_id (class method)">.<strong>tag_to_id</strong>(target)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert a tag to a room ID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#time_to_room-class_method" title="time_to_room (class method)">.<strong>time_to_room</strong>(origin, destination)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculate the time to travel from one room to another.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#walk_to-class_method" title="walk_to (class method)">.<strong>walk_to</strong>(target_room, restart_on_fail = true)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Walk to a specified room.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="ask_for_item?-class_method">
  
    .<strong>ask_for_item?</strong>(room, name, item)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Visit a merchant and ask for an item. Usually this is for bundling ropes or gem pouches. Visit a merchant and ask for an item. Usually this is for bundling ropes or gem pouches.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Asking for an item</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_ask_for_item?'>ask_for_item?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>market</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>merchant</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gem pouch</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The room where the merchant is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the merchant.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The item to ask for.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if the item is received, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 102</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ask_for_item?'>ask_for_item?</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_success_patterns'>success_patterns</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>hands you</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>

  <span class='id identifier rubyid_failure_patterns'>failure_patterns</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>does not seem to know anything about that</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>All I know about</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>To whom are you speaking</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Usage: ASK</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>

  <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ask </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item'>item</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_success_patterns'>success_patterns</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_failure_patterns'>failure_patterns</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>hands you</span><span class='regexp_end'>/</span></span>
    <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="buy_item-class_method">
  
    .<strong>buy_item</strong>(room, item)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Visit a merchant and buy an item by offering their asking price. Usually for restocking ammunition or other misc items. Visit a merchant and buy an item by offering their asking price. Usually for restocking ammunition or other misc items.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Buying an item</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_buy_item'>buy_item</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>market</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>arrows</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The room where the merchant is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The item to buy.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 54</span>

<span class='kw'>def</span> <span class='id identifier rubyid_buy_item'>buy_item</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='rparen'>)</span>

  <span class='comment'># Amount to pay should be first capturing group.
</span>  <span class='id identifier rubyid_patterns'>patterns</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>prepared to offer it to you for (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Let me but ask the humble sum of (.*) coins</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>it would be just (\d*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>for a (?:mere )?(\d*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I can let that go for...(.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>cost you (?:just )?(.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>it may be yours for just (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I&#39;ll give that to you for (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I&#39;ll let you have it for (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I ask that you give (.*) copper (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>it&#39;ll be (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>the price of (.*) coins? is all I ask</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>tis only (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>That will be (.*) copper (?:kronar|lirum|dokora)s? please</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>That&#39;ll be (.*) copper (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>to you for (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I ask (.*) copper (?:kronar|lirum|dokora)s or if you would prefer</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Cost you just (.*) (?:kronar|lirum|dokora)s?, okie dokie\?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>It will cost just (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I would suggest (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>to you for (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>asking (.*) (?:kronar|lirum|dokora)s?</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You decide to purchase</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Buy what</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_match'><span class='object_link'><a href="../../top-level-namespace.html#match-instance_method" title="#match (method)">match</a></span></span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>buy </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item'>item</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_patterns'>patterns</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_match'><span class='object_link'><a href="../../top-level-namespace.html#match-instance_method" title="#match (method)">match</a></span></span>
    <span class='id identifier rubyid_patterns'>patterns</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_match'><span class='object_link'><a href="../../top-level-namespace.html#match-instance_method" title="#match (method)">match</a></span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_amount'>amount</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_fput'><span class='object_link'><a href="../../top-level-namespace.html#fput-instance_method" title="#fput (method)">fput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offer </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_amount'>amount</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_amount'>amount</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dispose-class_method">
  
    .<strong>dispose</strong>(item, trash_room = nil, worn_trashcan = nil, worn_trashcan_verb = nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Dispose of an item in a trash can or designated area.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Disposing of an item</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_dispose'>dispose</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>old shoes</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>trash room</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The item to dispose of.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>trash_room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The room where the trash can is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>worn_trashcan</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The trash can being worn.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>worn_trashcan_verb</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The verb to use for disposing.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150
151
152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispose'>dispose</span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='comma'>,</span> <span class='id identifier rubyid_trash_room'>trash_room</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_worn_trashcan'>worn_trashcan</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_worn_trashcan_verb'>worn_trashcan_verb</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_item'>item</span>

  <span class='const'><span class='object_link'><a href="" title="Lich::DragonRealms::DRCT (module)">DRCT</a></span></span><span class='period'>.</span><span class='id identifier rubyid_walk_to'><span class='object_link'><a href="#walk_to-class_method" title="Lich::DragonRealms::DRCT.walk_to (method)">walk_to</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_trash_room'>trash_room</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_trash_room'>trash_room</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='const'><span class='object_link'><a href="DRCI.html" title="Lich::DragonRealms::DRCI (module)">DRCI</a></span></span><span class='period'>.</span><span class='id identifier rubyid_dispose_trash'><span class='object_link'><a href="DRCI.html#dispose_trash-class_method" title="Lich::DragonRealms::DRCI.dispose_trash (method)">dispose_trash</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='comma'>,</span> <span class='id identifier rubyid_worn_trashcan'>worn_trashcan</span><span class='comma'>,</span> <span class='id identifier rubyid_worn_trashcan_verb'>worn_trashcan_verb</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_empty_room-class_method">
  
    .<strong>find_empty_room</strong>(search_rooms, idle_room, predicate = nil, min_mana = 0, strict_mana = false, max_search_attempts = Float::INFINITY, priotize_buddies = false)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find an empty room based on specified criteria.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Finding an empty room</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='id identifier rubyid_find_empty_room'>find_empty_room</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idle room</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>search_rooms</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array of room IDs to search.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>idle_room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A room to go to if no empty room is found.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>predicate</span>
      
      
        <span class='type'>(<tt>Proc</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A condition to check for suitability.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>min_mana</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Minimum mana required to consider a room.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>strict_mana</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to enforce the minimum mana strictly.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_search_attempts</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Float::INFINITY</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Maximum attempts to find an empty room.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>priotize_buddies</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to prioritize rooms with friends.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if an empty room is found, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 353</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_empty_room'>find_empty_room</span><span class='lparen'>(</span><span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='comma'>,</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_min_mana'>min_mana</span> <span class='op'>=</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_strict_mana'>strict_mana</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_max_search_attempts'>max_search_attempts</span> <span class='op'>=</span> <span class='const'>Float</span><span class='op'>::</span><span class='const'>INFINITY</span><span class='comma'>,</span> <span class='id identifier rubyid_priotize_buddies'>priotize_buddies</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_search_attempt'>search_attempt</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_check_mana'>check_mana</span> <span class='op'>=</span> <span class='id identifier rubyid_min_mana'>min_mana</span> <span class='op'>&gt;</span> <span class='int'>0</span>
  <span class='id identifier rubyid_rooms_searched'>rooms_searched</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_search_attempt'>search_attempt</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** Search attempt </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_search_attempt'>search_attempt</span><span class='embexpr_end'>}</span><span class='tstring_content'> of </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_search_attempts'>max_search_attempts</span><span class='embexpr_end'>}</span><span class='tstring_content'> to find a suitable room. ***</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_found_empty'>found_empty</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_room_id'>room_id</span><span class='op'>|</span>
      <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='float'>0.1</span> <span class='kw'>until</span> <span class='id identifier rubyid_room_id'>room_id</span> <span class='op'>==</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>

      <span class='id identifier rubyid_rooms_searched'>rooms_searched</span> <span class='op'>+=</span> <span class='int'>1</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_priotize_buddies'>priotize_buddies</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='id identifier rubyid_rooms_searched'>rooms_searched</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_suitable_room'>suitable_room</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pcs'><span class='object_link'><a href="DRRoom.html#pcs-class_method" title="Lich::DragonRealms::DRRoom.pcs (method)">pcs</a></span></span> <span class='op'>&amp;</span> <span class='const'>UserVars</span><span class='period'>.</span><span class='id identifier rubyid_friends'>friends</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pcs'><span class='object_link'><a href="DRRoom.html#pcs-class_method" title="Lich::DragonRealms::DRRoom.pcs (method)">pcs</a></span></span> <span class='op'>&amp;</span> <span class='const'>UserVars</span><span class='period'>.</span><span class='id identifier rubyid_hunting_nemesis'>hunting_nemesis</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_rooms_searched'>rooms_searched</span> <span class='op'>==</span> <span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pcs'><span class='object_link'><a href="DRRoom.html#pcs-class_method" title="Lich::DragonRealms::DRRoom.pcs (method)">pcs</a></span></span> <span class='op'>&amp;</span> <span class='const'>UserVars</span><span class='period'>.</span><span class='id identifier rubyid_friends'>friends</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pcs'><span class='object_link'><a href="DRRoom.html#pcs-class_method" title="Lich::DragonRealms::DRRoom.pcs (method)">pcs</a></span></span> <span class='op'>&amp;</span> <span class='const'>UserVars</span><span class='period'>.</span><span class='id identifier rubyid_hunting_nemesis'>hunting_nemesis</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** Reached last room in list, and found no buddies. Retrying for empty room. ***</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='kw'>return</span> <span class='id identifier rubyid_find_empty_room'>find_empty_room</span><span class='lparen'>(</span><span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='comma'>,</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate'>predicate</span><span class='comma'>,</span> <span class='id identifier rubyid_min_mana'>min_mana</span><span class='comma'>,</span> <span class='id identifier rubyid_strict_mana'>strict_mana</span><span class='comma'>,</span> <span class='id identifier rubyid_max_search_attempts'>max_search_attempts</span><span class='comma'>,</span> <span class='id identifier rubyid_priotize_buddies'>priotize_buddies</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_suitable_room'>suitable_room</span> <span class='op'>=</span> <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>?</span> <span class='id identifier rubyid_predicate'>predicate</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_search_attempt'>search_attempt</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_pcs'><span class='object_link'><a href="DRRoom.html#pcs-class_method" title="Lich::DragonRealms::DRRoom.pcs (method)">pcs</a></span></span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_group_members'><span class='object_link'><a href="DRRoom.html#group_members-class_method" title="Lich::DragonRealms::DRRoom.group_members (method)">group_members</a></span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_suitable_room'>suitable_room</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_check_mana'>check_mana</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRStats.html" title="Lich::DragonRealms::DRStats (module)">DRStats</a></span></span><span class='period'>.</span><span class='id identifier rubyid_moon_mage?'><span class='object_link'><a href="DRStats.html#moon_mage%3F-class_method" title="Lich::DragonRealms::DRStats.moon_mage? (method)">moon_mage?</a></span></span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="DRStats.html" title="Lich::DragonRealms::DRStats (module)">DRStats</a></span></span><span class='period'>.</span><span class='id identifier rubyid_trader?'><span class='object_link'><a href="DRStats.html#trader%3F-class_method" title="Lich::DragonRealms::DRStats.trader? (method)">trader?</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_found_empty'>found_empty</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_suitable_room'>suitable_room</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRCA.html" title="Lich::DragonRealms::DRCA (module)">DRCA</a></span></span><span class='period'>.</span><span class='id identifier rubyid_perc_mana'><span class='object_link'><a href="DRCA.html#perc_mana-class_method" title="Lich::DragonRealms::DRCA.perc_mana (method)">perc_mana</a></span></span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_min_mana'>min_mana</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_suitable_room'>suitable_room</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_found_empty'>found_empty</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_check_mana'>check_mana</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_strict_mana'>strict_mana</span>
      <span class='id identifier rubyid_check_mana'>check_mana</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*** Empty rooms found, but not with the right mana. Going to use those anyway! ***</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>

    <span class='lparen'>(</span><span class='id identifier rubyid_check_mana'>check_mana</span> <span class='op'>=</span> <span class='id identifier rubyid_min_mana'>min_mana</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_check_mana'>check_mana</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_idle_room'>idle_room</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_search_attempt'>search_attempt</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_max_search_attempts'>max_search_attempts</span>
      <span class='id identifier rubyid_idle_room'>idle_room</span> <span class='op'>=</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='period'>.</span><span class='id identifier rubyid_sample'>sample</span> <span class='kw'>if</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_idle_room'>idle_room</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_wait_time'>wait_time</span> <span class='op'>=</span> <span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>20</span><span class='op'>..</span><span class='int'>40</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** Failed to find an empty room, pausing </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wait_time'>wait_time</span><span class='embexpr_end'>}</span><span class='tstring_content'> seconds ***</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='id identifier rubyid_wait_time'>wait_time</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*** Failed to find an empty room, stopping the search ***</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_sorted_empty_room-class_method">
  
    .<strong>find_sorted_empty_room</strong>(search_rooms, idle_room, predicate = nil)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Find an empty room from a sorted list of rooms.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Finding a sorted empty room</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='id identifier rubyid_find_sorted_empty_room'>find_sorted_empty_room</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idle room</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>search_rooms</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array of room IDs to search.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>idle_room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A room to go to if no empty room is found.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>predicate</span>
      
      
        <span class='type'>(<tt>Proc</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A condition to check for suitability.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if an empty room is found, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


423
424
425
426</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 423</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_sorted_empty_room'>find_sorted_empty_room</span><span class='lparen'>(</span><span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='comma'>,</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sorted_rooms'>sorted_rooms</span> <span class='op'>=</span> <span class='id identifier rubyid_sort_destinations'>sort_destinations</span><span class='lparen'>(</span><span class='id identifier rubyid_search_rooms'>search_rooms</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_find_empty_room'>find_empty_room</span><span class='lparen'>(</span><span class='id identifier rubyid_sorted_rooms'>sorted_rooms</span><span class='comma'>,</span> <span class='id identifier rubyid_idle_room'>idle_room</span><span class='comma'>,</span> <span class='id identifier rubyid_predicate'>predicate</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_hometown_target_id-class_method">
  
    .<strong>get_hometown_target_id</strong>(hometown, target)  &#x21d2; <tt>Integer</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get the target ID for a specific target in a hometown.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Getting a target ID</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_target_id'>target_id</span> <span class='op'>=</span> <span class='id identifier rubyid_get_hometown_target_id'>get_hometown_target_id</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>town</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>blacksmith</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>hometown</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the hometown.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The target to find.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ID of the target, or nil if not found.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 476</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_hometown_target_id'>get_hometown_target_id</span><span class='lparen'>(</span><span class='id identifier rubyid_hometown'>hometown</span><span class='comma'>,</span> <span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hometown_data'>hometown_data</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data'>get_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>town</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_hometown'>hometown</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_target_id'>target_id</span> <span class='op'>=</span> <span class='id identifier rubyid_hometown_data'>hometown_data</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hometown_data'>hometown_data</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='comment'># try twice with pause if failed the first time, because sometimes data doesn&#39;t get loaded correctly
</span>  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_target_id'>target_id</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** get_hometown_target_id failed first attempt for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hometown'>hometown</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Trying again:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='gvar'>$common_travel_debug</span>
    <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='int'>2</span>
    <span class='id identifier rubyid_hometown_data'>hometown_data</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data'>get_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>town</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_hometown'>hometown</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_target_id'>target_id</span> <span class='op'>=</span> <span class='id identifier rubyid_hometown_data'>hometown_data</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hometown_data'>hometown_data</span><span class='lbracket'>[</span><span class='id identifier rubyid_target'>target</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_target_id'>target_id</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** get_hometown_target_id failed second attempt for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hometown'>hometown</span><span class='embexpr_end'>}</span><span class='tstring_content'>.  Likely target doesn&#39;t exist</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='gvar'>$common_travel_debug</span>
      <span class='id identifier rubyid_target_id'>target_id</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** get_hometown_target_id succeeded second attempt for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hometown'>hometown</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='gvar'>$common_travel_debug</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*** target_id = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target_id'>target_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='gvar'>$common_travel_debug</span>
  <span class='id identifier rubyid_target_id'>target_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="order_item-class_method">
  
    .<strong>order_item</strong>(room, item_number)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Visit a merchant and order from a menu. Visit a merchant and order from a menu.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Ordering an item</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_order_item'>order_item</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tavern</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The room where the merchant is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>item_number</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of the item to order.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_order_item'>order_item</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='id identifier rubyid_item_number'>item_number</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>order </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item_number'>item_number</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Just order it again</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>you don\&#39;t have enough coins</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>you don\&#39;t have enough coins</span><span class='tstring_end'>&#39;</span></span>

  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>order </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item_number'>item_number</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>takes some coins from you</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="refill_lockpick_container-class_method">
  
    .<strong>refill_lockpick_container</strong>(lockpick_type, hometown, container, count)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Refill a lockpick container with a specified type of lockpick.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Refilling a lockpick container</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_refill_lockpick_container'>refill_lockpick_container</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>basic</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>town</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lockpick case</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>5</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>lockpick_type</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of lockpick to refill.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>hometown</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The hometown where the locksmith is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>container</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The container to refill.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>count</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of lockpicks to buy.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 162</span>

<span class='kw'>def</span> <span class='id identifier rubyid_refill_lockpick_container'>refill_lockpick_container</span><span class='lparen'>(</span><span class='id identifier rubyid_lockpick_type'>lockpick_type</span><span class='comma'>,</span> <span class='id identifier rubyid_hometown'>hometown</span><span class='comma'>,</span> <span class='id identifier rubyid_container'>container</span><span class='comma'>,</span> <span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='int'>1</span>

  <span class='id identifier rubyid_room'>room</span> <span class='op'>=</span> <span class='id identifier rubyid_get_data'>get_data</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>town</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_hometown'>hometown</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locksmithing</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>***No locksmith location found for current Hometown! Skipping refilling!***</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>!=</span> <span class='id identifier rubyid_room'>room</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>***Could not reach locksmith location! Skipping refilling!***</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_count'>count</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_buy_item'>buy_item</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_lockpick_type'>lockpick_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> lockpick</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>put my lockpick on my </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_container'>container</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You put</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>different kinds of lockpicks on the same lockpick</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>different kinds of lockpicks on the same lockpick</span><span class='tstring_end'>&#39;</span></span>
      <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_message'><span class='object_link'><a href="DRC.html#message-class_method" title="Lich::DragonRealms::DRC.message (method)">message</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>There is something wrong with your lockpick settings. Mixing types in a container is not allowed.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>break</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Be polite to Thieves, who need the room to be empty
</span>  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fix_standing'><span class='object_link'><a href="DRC.html#fix_standing-class_method" title="Lich::DragonRealms::DRC.fix_standing (method)">fix_standing</a></span></span>
  <span class='id identifier rubyid_move'><span class='object_link'><a href="../../top-level-namespace.html#move-instance_method" title="#move (method)">move</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>out</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_exits'>room_exits</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>out</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retreat-class_method">
  
    .<strong>retreat</strong>(ignored_npcs = [])  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Retreat from a room, avoiding specified NPCs.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Retreating from a room</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_retreat'>retreat</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>goblin</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ignored_npcs</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>An array of NPCs to ignore while retreating.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


336
337
338
339
340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 336</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retreat'>retreat</span><span class='lparen'>(</span><span class='id identifier rubyid_ignored_npcs'>ignored_npcs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="DRRoom.html" title="Lich::DragonRealms::DRRoom (class)">DRRoom</a></span></span><span class='period'>.</span><span class='id identifier rubyid_npcs'><span class='object_link'><a href="DRRoom.html#npcs-class_method" title="Lich::DragonRealms::DRRoom.npcs (method)">npcs</a></span></span> <span class='op'>-</span> <span class='id identifier rubyid_ignored_npcs'>ignored_npcs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_retreat'><span class='object_link'><a href="DRC.html#retreat-class_method" title="Lich::DragonRealms::DRC.retreat (method)">retreat</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_ignored_npcs'>ignored_npcs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reverse_path-class_method">
  
    .<strong>reverse_path</strong>(path)  &#x21d2; <tt>Array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reverse a path of directions.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Reversing a path</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_reversed'>reversed</span> <span class='op'>=</span> <span class='id identifier rubyid_reverse_path'>reverse_path</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>north</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>east</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array of directions to reverse.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array of reversed directions.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>StandardError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Raises an error if a direction cannot be reversed.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 445</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reverse_path'>reverse_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dir_to_prev_dir'>dir_to_prev_dir</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>northeast</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>southwest</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>southwest</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>northeast</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>northwest</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>southeast</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>southeast</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>northwest</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>north</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>south</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>south</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>north</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>east</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>west</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>west</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>east</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>up</span><span class='tstring_end'>&#39;</span></span>        <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>down</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>down</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>up</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_reverse_path'>reverse_path</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>-</span> <span class='int'>1</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dir_to_prev_dir'>dir_to_prev_dir</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_message'><span class='object_link'><a href="DRC.html#message-class_method" title="Lich::DragonRealms::DRC.message (method)">message</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error: No reverse direction found for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>.  Please use the full direction, northeast instead of ne, check your spelling, and make sure the path parameter is an array.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_exit'>exit</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_reverse_path'>reverse_path</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_dir_to_prev_dir'>dir_to_prev_dir</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_reverse_path'>reverse_path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sell_item-class_method">
  
    .<strong>sell_item</strong>(room, item)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Visit a merchant and sell an item. Usually to sell junk at pawn shops. Visit a merchant and sell an item. Usually to sell junk at pawn shops.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Selling an item</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_sell_item'>sell_item</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pawn shop</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>old sword</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The room where the merchant is located.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>item</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The item to sell.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if the item was sold, false otherwise.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>StandardError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Raises an error if the item is not in hands.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 21</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sell_item'>sell_item</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="DRCI.html" title="Lich::DragonRealms::DRCI (module)">DRCI</a></span></span><span class='period'>.</span><span class='id identifier rubyid_in_hands?'><span class='object_link'><a href="DRCI.html#in_hands%3F-class_method" title="Lich::DragonRealms::DRCI.in_hands? (method)">in_hands?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_success_patterns'>success_patterns</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>hands? you \d+ (kronars|lirums|dokoras)</span><span class='regexp_end'>/i</span></span>
  <span class='rbracket'>]</span>

  <span class='id identifier rubyid_failure_patterns'>failure_patterns</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I need to examine the merchandise first</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>That&#39;s not worth anything</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>I only deal in pelts</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>There&#39;s folk around here that&#39;d slit a throat for this</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>

  <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sell my </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_item'>item</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_success_patterns'>success_patterns</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_failure_patterns'>failure_patterns</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_success_patterns'>success_patterns</span>
    <span class='kw'>true</span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_failure_patterns'>failure_patterns</span>
    <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sort_destinations-class_method">
  
    .<strong>sort_destinations</strong>(target_list)  &#x21d2; <tt>Array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sort a list of destinations based on distance from the current room.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Sorting destinations</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_sorted_rooms'>sorted_rooms</span> <span class='op'>=</span> <span class='id identifier rubyid_sort_destinations'>sort_destinations</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>3</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target_list</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array of room IDs to sort.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A sorted array of room IDs.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


409
410
411
412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 409</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sort_destinations'>sort_destinations</span><span class='lparen'>(</span><span class='id identifier rubyid_target_list'>target_list</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target_list'>target_list</span> <span class='op'>=</span> <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_i</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__previous'>_previous</span><span class='comma'>,</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span> <span class='op'>=</span> <span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_dijkstra'>dijkstra</span><span class='lparen'>(</span><span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_room_num'>room_num</span><span class='op'>|</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>!=</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_b'>b</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tag_to_id-class_method">
  
    .<strong>tag_to_id</strong>(target)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert a tag to a room ID.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Getting a room ID from a tag</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_room_id'>room_id</span> <span class='op'>=</span> <span class='id identifier rubyid_tag_to_id'>tag_to_id</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tavern</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The tag to convert.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ID of the room associated with the tag.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>StandardError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Raises an error if no matching room is found.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 303</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tag_to_id'>tag_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_start_room'>start_room</span> <span class='op'>=</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_target_list'>target_list</span> <span class='op'>=</span> <span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='period'>.</span><span class='id identifier rubyid_find_all'>find_all</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_room'>room</span><span class='op'>|</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_tags'>tags</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_room'>room</span><span class='op'>|</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_message'><span class='object_link'><a href="DRC.html#message-class_method" title="Lich::DragonRealms::DRC.message (method)">message</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No go2 targets matching </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> found!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_exit'>exit</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_start_room'>start_room</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You&#39;re already here...</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_start_room'>start_room</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid__previous'>_previous</span><span class='comma'>,</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span> <span class='op'>=</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_dijkstra'>dijkstra</span><span class='lparen'>(</span><span class='id identifier rubyid_target_list'>target_list</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_room_id'>room_id</span><span class='op'>|</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_message'><span class='object_link'><a href="DRC.html#message-class_method" title="Lich::DragonRealms::DRC.message (method)">message</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t find a path from here to any room with a </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'> tag</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_exit'>exit</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_target_id'>target_id</span> <span class='op'>=</span> <span class='id identifier rubyid_target_list'>target_list</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_shortest_distances'>shortest_distances</span><span class='lbracket'>[</span><span class='id identifier rubyid_b'>b</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_target_id'>target_id</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_destination'>destination</span> <span class='op'>=</span> <span class='const'>Map</span><span class='lbracket'>[</span><span class='id identifier rubyid_target_id'>target_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_message'><span class='object_link'><a href="DRC.html#message-class_method" title="Lich::DragonRealms::DRC.message (method)">message</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Something went wrong!  Debug failed with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target_id'>target_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_destination'>destination</span><span class='embexpr_end'>}</span><span class='tstring_content'>, and </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_exit'>exit</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_target_id'>target_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="time_to_room-class_method">
  
    .<strong>time_to_room</strong>(origin, destination)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculate the time to travel from one room to another.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Calculating time to a room</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='id identifier rubyid_time_to_room'>time_to_room</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>3</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>origin</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ID of the starting room.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>destination</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The ID of the destination room.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The time taken to travel to the destination room.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


434
435
436
437</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 434</span>

<span class='kw'>def</span> <span class='id identifier rubyid_time_to_room'>time_to_room</span><span class='lparen'>(</span><span class='id identifier rubyid_origin'>origin</span><span class='comma'>,</span> <span class='id identifier rubyid_destination'>destination</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__previous'>_previous</span><span class='comma'>,</span> <span class='id identifier rubyid_shortest_paths'>shortest_paths</span> <span class='op'>=</span> <span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_dijkstra'>dijkstra</span><span class='lparen'>(</span><span class='id identifier rubyid_origin'>origin</span><span class='comma'>,</span> <span class='id identifier rubyid_destination'>destination</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_shortest_paths'>shortest_paths</span><span class='lbracket'>[</span><span class='id identifier rubyid_destination'>destination</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="walk_to-class_method">
  
    .<strong>walk_to</strong>(target_room, restart_on_fail = true)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Walk to a specified room.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Walking to a room</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>market</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target_room</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The room to walk to, can be a name or ID.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>restart_on_fail</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether to retry if the first attempt fails.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if successfully reached the room, false otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-travel.rb', line 198</span>

<span class='kw'>def</span> <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_target_room'>target_room</span><span class='comma'>,</span> <span class='id identifier rubyid_restart_on_fail'>restart_on_fail</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_target_room'>target_room</span> <span class='op'>=</span> <span class='id identifier rubyid_tag_to_id'>tag_to_id</span><span class='lparen'>(</span><span class='id identifier rubyid_target_room'>target_room</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_target_room'>target_room</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_target_room'>target_room</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a-zA-Z</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>0</span>

  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_target_room'>target_room</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>=</span> <span class='id identifier rubyid_target_room'>target_room</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>==</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>

  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fix_standing'><span class='object_link'><a href="DRC.html#fix_standing-class_method" title="Lich::DragonRealms::DRC.fix_standing (method)">fix_standing</a></span></span>

  <span class='kw'>if</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In an unknown room, manually attempting to navigate to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_room_num'>room_num</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_rooms'>rooms</span> <span class='op'>=</span> <span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_list'>list</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_room'>room</span><span class='op'>|</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_description'>room_description</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_title'>room_title</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_rooms'>rooms</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_rooms'>rooms</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span>
      <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>failed to find a matching room</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_room'>room</span> <span class='op'>=</span> <span class='id identifier rubyid_rooms'>rooms</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>==</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_wayto'>wayto</span><span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_move'><span class='object_link'><a href="../../top-level-namespace.html#move-instance_method" title="#move (method)">move</a></span></span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_wayto'>wayto</span><span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>==</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_findpath'>findpath</span><span class='lparen'>(</span><span class='id identifier rubyid_room'>room</span><span class='comma'>,</span> <span class='const'>Map</span><span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_way'>way</span> <span class='op'>=</span> <span class='id identifier rubyid_room'>room</span><span class='period'>.</span><span class='id identifier rubyid_wayto'>wayto</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_way'>way</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>StringProc</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_way'>way</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_move'><span class='object_link'><a href="../../top-level-namespace.html#move-instance_method" title="#move (method)">move</a></span></span> <span class='id identifier rubyid_way'>way</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room_num'>room_num</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_script_handle'>script_handle</span> <span class='op'>=</span> <span class='id identifier rubyid_start_script'><span class='object_link'><a href="../../top-level-namespace.html#start_script-instance_method" title="#start_script (method)">start_script</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>go2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>force:</span> <span class='kw'>true</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_timer'>timer</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_prev_room'>prev_room</span> <span class='op'>=</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_description'>room_description</span> <span class='op'>+</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_title'>room_title</span>

  <span class='comment'># Moved flag declaration from the start of the method to here
</span>  <span class='comment'># so that they only exist when needed and because the above code
</span>  <span class='comment'># has lots of &#39;return&#39; statements that&#39;d have to be refactored to
</span>  <span class='comment'># properly delete the flags at each method exit point.
</span>  <span class='comment'># I didn&#39;t want to tackle that endeavor in this change.
</span>  <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_add'><span class='object_link'><a href="Flags.html#add-class_method" title="Lich::DragonRealms::Flags.add (method)">add</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-closed-shop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>The door is locked up tightly for the night</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You smash your nose</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>^A servant (blocks|stops)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_add'><span class='object_link'><a href="Flags.html#add-class_method" title="Lich::DragonRealms::Flags.add (method)">add</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-engaged</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You are engaged</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>while</span> <span class='const'>Script</span><span class='period'>.</span><span class='id identifier rubyid_running'>running</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_script_handle'>script_handle</span><span class='rparen'>)</span>
    <span class='comment'># Shop closed, stop script and open door then restart
</span>    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-closed-shop</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reset'><span class='object_link'><a href="Flags.html#reset-class_method" title="Lich::DragonRealms::Flags.reset (method)">reset</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-closed-shop</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_kill_script'>kill_script</span><span class='lparen'>(</span><span class='id identifier rubyid_script_handle'>script_handle</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>You open</span><span class='regexp_end'>/</span></span> <span class='op'>!~</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>open door</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>It is locked</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You .+</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>What were</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='comment'># You cannot get to where you want to go,
</span>        <span class='comment'># and no amount of retries will get you through the locked door.
</span>        <span class='id identifier rubyid_restart_on_fail'>restart_on_fail</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_timer'>timer</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
      <span class='id identifier rubyid_script_handle'>script_handle</span> <span class='op'>=</span> <span class='id identifier rubyid_start_script'><span class='object_link'><a href="../../top-level-namespace.html#start_script-instance_method" title="#start_script (method)">start_script</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>go2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='comment'># You&#39;re engaged, stop script and retreat then restart
</span>    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-engaged</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_reset'><span class='object_link'><a href="Flags.html#reset-class_method" title="Lich::DragonRealms::Flags.reset (method)">reset</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-engaged</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_kill_script'>kill_script</span><span class='lparen'>(</span><span class='id identifier rubyid_script_handle'>script_handle</span><span class='rparen'>)</span>
      <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_retreat'><span class='object_link'><a href="DRC.html#retreat-class_method" title="Lich::DragonRealms::DRC.retreat (method)">retreat</a></span></span>
      <span class='id identifier rubyid_timer'>timer</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
      <span class='id identifier rubyid_script_handle'>script_handle</span> <span class='op'>=</span> <span class='id identifier rubyid_start_script'><span class='object_link'><a href="../../top-level-namespace.html#start_script-instance_method" title="#start_script (method)">start_script</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>go2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='comment'># Something interferred with movement, stop script then restart
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_timer'>timer</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>90</span>
      <span class='id identifier rubyid_kill_script'>kill_script</span><span class='lparen'>(</span><span class='id identifier rubyid_script_handle'>script_handle</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='float'>0.5</span> <span class='kw'>while</span> <span class='const'>Script</span><span class='period'>.</span><span class='id identifier rubyid_running'>running</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_script_handle'>script_handle</span><span class='rparen'>)</span>
      <span class='kw'>break</span> <span class='kw'>unless</span> <span class='id identifier rubyid_restart_on_fail'>restart_on_fail</span>

      <span class='id identifier rubyid_timer'>timer</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
      <span class='id identifier rubyid_script_handle'>script_handle</span> <span class='op'>=</span> <span class='id identifier rubyid_start_script'><span class='object_link'><a href="../../top-level-namespace.html#start_script-instance_method" title="#start_script (method)">start_script</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>go2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='id identifier rubyid_room_num'>room_num</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='comment'># If an escort script is running or we&#39;re making progress then update our timer so we don&#39;t timeout (see above)
</span>    <span class='kw'>if</span> <span class='const'>Script</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>escort</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='const'>Script</span><span class='period'>.</span><span class='id identifier rubyid_running?'>running?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bescort</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_description'>room_description</span> <span class='op'>+</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_title'>room_title</span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='id identifier rubyid_prev_room'>prev_room</span> <span class='op'>||</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_description'>room_description</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>The terrain constantly changes as you travel along on your journey</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_timer'>timer</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
    <span class='kw'>end</span>
    <span class='comment'># Where did you come from, where did you go? Where did you come from, Cotten-Eye Joe?
</span>    <span class='id identifier rubyid_prev_room'>prev_room</span> <span class='op'>=</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_description'>room_description</span> <span class='op'>+</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_room_title'>room_title</span>
    <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='float'>0.5</span>
  <span class='kw'>end</span>

  <span class='comment'># Delete flags, no longer needed at this point
</span>  <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="Flags.html#delete-class_method" title="Lich::DragonRealms::Flags.delete (method)">delete</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-closed-shop</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Flags.html" title="Lich::DragonRealms::Flags (class)">Flags</a></span></span><span class='period'>.</span><span class='id identifier rubyid_delete'><span class='object_link'><a href="Flags.html#delete-class_method" title="Lich::DragonRealms::Flags.delete (method)">delete</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>travel-engaged</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Consider just returning this boolean and letting callers decide what to do on a failed move.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>!=</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_restart_on_fail'>restart_on_fail</span>
    <span class='id identifier rubyid_echo'><span class='object_link'><a href="../../top-level-namespace.html#echo-instance_method" title="#echo (method)">echo</a></span></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to navigate to room </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_room_num'>room_num</span><span class='embexpr_end'>}</span><span class='tstring_content'>, attempting again</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_walk_to'>walk_to</span><span class='lparen'>(</span><span class='id identifier rubyid_room_num'>room_num</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_room_num'>room_num</span> <span class='op'>==</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Nov  7 08:04:20 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.9).
</div>

    </div>
  </body>
</html>