<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Lich::DragonRealms::DRCH
  
    &mdash; Lich 5 Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Lich::DragonRealms::DRCH";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Lich.html" title="Lich (module)">Lich</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DragonRealms.html" title="Lich::DragonRealms (module)">DragonRealms</a></span></span>
     &raquo; 
    <span class="title">DRCH</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Lich::DragonRealms::DRCH
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>documented/dragonrealms/commons/common-healing.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Module for DragonRealms Combat Healing This module provides methods for checking health and managing wounds.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bind_wound-class_method" title="bind_wound (class method)">.<strong>bind_wound</strong>(body_part, person = &#39;my&#39;)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tends to a specified wound on the body.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#calculate_score-class_method" title="calculate_score (class method)">.<strong>calculate_score</strong>(wounds_by_severity)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Compute a weighted summary score from a wound list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_health-class_method" title="check_health (class method)">.<strong>check_health</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Uses HEALTH command to check for poisons, diseases, bleeders, parasites, and lodged items.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_tendable_bleeders%3F-class_method" title="has_tendable_bleeders? (class method)">.<strong>has_tendable_bleeders?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if there are any tendable bleeders.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_bleeders-class_method" title="parse_bleeders (class method)">.<strong>parse_bleeders</strong>(health_lines)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given lines of text from the HEALTH command output in reverse, returns a map of any bleeding wounds where the keys are the severity and the values are the list of bleeding wounds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_lodged_items-class_method" title="parse_lodged_items (class method)">.<strong>parse_lodged_items</strong>(lodged_line)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given the line of text from the HEALTH command output that expresses items lodged into you, returns a map of any lodged items where the keys are the severity and the values are the list of wounds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_parasites-class_method" title="parse_parasites (class method)">.<strong>parse_parasites</strong>(parasites_line)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given the line of text from the HEALTH command output that expresses parasites latched to you, returns a map of any parasites where the keys are the severity and the values are the list of wounds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_perceived_health-class_method" title="parse_perceived_health (class method)">.<strong>parse_perceived_health</strong>(target = nil)  &#x21d2; Hash<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Examples of what this parses can be found in test/test_check_health.rb Parses the perceived health data of a target.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_wounds-class_method" title="parse_wounds (class method)">.<strong>parse_wounds</strong>(wounds_line)  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Given the line of text from the HEALTH command output that expresses external and internal wounds and scars, returns a map of any wounds where the keys are the severity and the values are the list of wounds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#perceive_health-class_method" title="perceive_health (class method)">.<strong>perceive_health</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Uses PERCEIVE HEALTH SELF command to check for wounds and scars.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#perceive_health_other-class_method" title="perceive_health_other (class method)">.<strong>perceive_health_other</strong>(target)  &#x21d2; Hash<sup>?</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks the health of another target using empathic abilities.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skilled_to_tend_wound%3F-class_method" title="skilled_to_tend_wound? (class method)">.<strong>skilled_to_tend_wound?</strong>(bleed_rate, internal = false)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Skill check to tend a bleeding wound.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unwrap_wound-class_method" title="unwrap_wound (class method)">.<strong>unwrap_wound</strong>(body_part, person = &#39;my&#39;)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Unwraps the bandages from a specified wound.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="bind_wound-class_method">
  
    .<strong>bind_wound</strong>(body_part, person = &#39;my&#39;)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tends to a specified wound on the body.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='id identifier rubyid_bind_wound'>bind_wound</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>left arm</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>body_part</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The body part to tend</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>person</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;my&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The person to tend, defaults to ‘my’</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if tending was successful, false otherwise</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 383</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bind_wound'>bind_wound</span><span class='lparen'>(</span><span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span> <span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='comment'># Either you tended it or it already has bandages on. Good job!
</span>  <span class='id identifier rubyid_tend_success'>tend_success</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>You work carefully at tending</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>You work carefully at binding</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>That area has already been tended to</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>That area is not bleeding</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>
  <span class='comment'># Yeouch, you couldn&#39;t tend the wound. Might have made it worse!
</span>  <span class='id identifier rubyid_tend_failure'>tend_failure</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>You fumble</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>too injured for you to do that</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>TEND allows for the tending of wounds</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You must have a hand free</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>
  <span class='comment'># You dislodged ammo or a parasite, discard it. Note, some parasites go away and don&#39;t
</span>  <span class='comment'># end up in your hand. Fine, it&#39;ll just fail to dispose.
</span>  <span class='id identifier rubyid_tend_dislodge'>tend_dislodge</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You \w+ remove (a|the|some) (.*) from</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^As you reach for the clay fragment</span><span class='regexp_end'>/</span></span>
  <span class='rbracket'>]</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tend </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_person'>person</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_body_part'>body_part</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_tend_success'>tend_success</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_tend_failure'>tend_failure</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_tend_dislodge'>tend_dislodge</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_waitrt?'><span class='object_link'><a href="../../top-level-namespace.html#waitrt%3F-instance_method" title="#waitrt? (method)">waitrt?</a></span></span>
  <span class='kw'>case</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_tend_dislodge'>tend_dislodge</span>
    <span class='const'><span class='object_link'><a href="DRCI.html" title="Lich::DragonRealms::DRCI (module)">DRCI</a></span></span><span class='period'>.</span><span class='id identifier rubyid_dispose_trash'><span class='object_link'><a href="DRCI.html#dispose_trash-class_method" title="Lich::DragonRealms::DRCI.dispose_trash (method)">dispose_trash</a></span></span><span class='lparen'>(</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_get_settings'>get_settings</span><span class='period'>.</span><span class='id identifier rubyid_worn_trashcan'>worn_trashcan</span><span class='comma'>,</span> <span class='id identifier rubyid_get_settings'>get_settings</span><span class='period'>.</span><span class='id identifier rubyid_worn_trashcan_verb'>worn_trashcan_verb</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_bind_wound'>bind_wound</span><span class='lparen'>(</span><span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span> <span class='id identifier rubyid_person'>person</span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='op'>*</span><span class='id identifier rubyid_tend_failure'>tend_failure</span>
    <span class='kw'>false</span>
  <span class='kw'>else</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="calculate_score-class_method">
  
    .<strong>calculate_score</strong>(wounds_by_severity)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Compute a weighted summary score from a wound list. Commonly used for thresholding for healing activities Compute a weighted summary score from a wound list. Commonly used for thresholding for healing activities</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_score'>score</span> <span class='op'>=</span> <span class='id identifier rubyid_calculate_score'>calculate_score</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds'>wounds</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>wounds_by_severity</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash of wounds categorized by severity</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The calculated score</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


454
455
456</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 454</span>

<span class='kw'>def</span> <span class='id identifier rubyid_calculate_score'>calculate_score</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds_by_severity'>wounds_by_severity</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wounds_by_severity'>wounds_by_severity</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_severity'>severity</span><span class='comma'>,</span> <span class='id identifier rubyid_wound_list'>wound_list</span><span class='op'>|</span> <span class='lparen'>(</span><span class='id identifier rubyid_severity'>severity</span><span class='op'>**</span><span class='int'>2</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_wound_list'>wound_list</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_reduce'>reduce</span><span class='lparen'>(</span><span class='symbol'>:+</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_health-class_method">
  
    .<strong>check_health</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Uses HEALTH command to check for poisons, diseases, bleeders, parasites, and lodged items. Based on this diagnostic information, you should be able to prioritize how you heal yourself with medicinal potions and salves, or healing spells. Uses HEALTH command to check for poisons, diseases, bleeders, parasites, and lodged items. Based on this diagnostic information, you should be able to prioritize how you heal yourself with medicinal potions and salves, or healing spells.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_health_data'>health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_check_health'>check_health</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_health_data'>health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wounds</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing health data including wounds, bleeders, parasites, lodged items, poisoned, diseased, and score</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 33</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_health'>check_health</span>
  <span class='id identifier rubyid_parasites_regex'>parasites_regex</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='gvar'>$DRCH_PARASITES_REGEX_LIST</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wounds_line'>wounds_line</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_parasites_line'>parasites_line</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_lodged_line'>lodged_line</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_diseased'>diseased</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_poisoned'>poisoned</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>health</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You have</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You feel somewhat tired and seem to be having trouble breathing</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Your wounds</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Your body</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='float'>0.5</span>
  <span class='id identifier rubyid_health_lines'>health_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_reget'><span class='object_link'><a href="../../top-level-namespace.html#reget-instance_method" title="#reget (method)">reget</a></span></span><span class='lparen'>(</span><span class='int'>50</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>

  <span class='id identifier rubyid_health_lines'>health_lines</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_line'>line</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Your body feels\b.*(?:strength|battered|beat up|bad shape|death&#39;s door|dead)</span><span class='regexp_end'>/</span></span>
      <span class='comment'># While iterating the game output in reverse,
</span>      <span class='comment'># this line represents the start of `HEALTH` command
</span>      <span class='comment'># so we can now break out of the loop and avoid
</span>      <span class='comment'># parsing text prior to the latest HEALTH command.
</span>      <span class='comment'># We don&#39;t need to parse this line, just use implicit `health` numeric variable.
</span>      <span class='kw'>break</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Your spirit feels\b.*(?:mighty and unconquerable|full of life|strong|wavering slightly|shaky|weak|cold|empty|lifeless|dead)</span><span class='regexp_end'>/</span></span>
      <span class='comment'># This line is your spirit health.
</span>      <span class='comment'># We don&#39;t need to parse this line, just use implicit `spirit` numeric variable.
</span>      <span class='kw'>next</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have (?!no significant injuries)(?!.* lodged .* in(?:to)? your)(?!.* infection)(?!.* poison(?:ed)?)(?!.* </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parasites_regex'>parasites_regex</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_wounds_line'>wounds_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have .* lodged .* in(?:to)? your</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_lodged_line'>lodged_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have a .* on your</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='id identifier rubyid_parasites_regex'>parasites_regex</span>
      <span class='id identifier rubyid_parasites_line'>parasites_line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have a dormant infection</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Your wounds are infected</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Your body is covered in open oozing sores</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_diseased'>diseased</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have .* poison(?:ed)?</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You feel somewhat tired and seem to be having trouble breathing</span><span class='regexp_end'>/</span></span>
      <span class='id identifier rubyid_poisoned'>poisoned</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_bleeders'>bleeders</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_bleeders'>parse_bleeders</span><span class='lparen'>(</span><span class='id identifier rubyid_health_lines'>health_lines</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wounds'>wounds</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_wounds'>parse_wounds</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parasites'>parasites</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_parasites'>parse_parasites</span><span class='lparen'>(</span><span class='id identifier rubyid_parasites_line'>parasites_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lodged_items'>lodged_items</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_lodged_items'>parse_lodged_items</span><span class='lparen'>(</span><span class='id identifier rubyid_lodged_line'>lodged_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_score'>score</span> <span class='op'>=</span> <span class='id identifier rubyid_calculate_score'>calculate_score</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds'>wounds</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wounds</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bleeders</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_bleeders'>bleeders</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>parasites</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_parasites'>parasites</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>lodged</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_lodged_items'>lodged_items</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>poisoned</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_poisoned'>poisoned</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>diseased</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_diseased'>diseased</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_score'>score</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_tendable_bleeders?-class_method">
  
    .<strong>has_tendable_bleeders?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if there are any tendable bleeders</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_has_tendable_bleeders?'>has_tendable_bleeders?</span> <span class='comment'>#=&gt; true</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if there are tendable bleeders, false otherwise</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_tendable_bleeders?'>has_tendable_bleeders?</span>
  <span class='id identifier rubyid_health_data'>health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_check_health'>check_health</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_health_data'>health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bleeders</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_wound'>wound</span><span class='op'>|</span> <span class='id identifier rubyid_wound'>wound</span><span class='period'>.</span><span class='id identifier rubyid_tendable?'>tendable?</span> <span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_bleeders-class_method">
  
    .<strong>parse_bleeders</strong>(health_lines)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given lines of text from the HEALTH command output in reverse, returns a map of any bleeding wounds where the keys are the severity and the values are the list of bleeding wounds. Given lines of text from the HEALTH command output in reverse, returns a map of any bleeding wounds where the keys are the severity and the values are the list of bleeding wounds.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_bleeders'>bleeders</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_bleeders'>parse_bleeders</span><span class='lparen'>(</span><span class='id identifier rubyid_health_lines'>health_lines</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>health_lines</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="../../String.html" title="String (class)">String</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Lines of health command output</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing bleeding wounds categorized by severity</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 245</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_bleeders'>parse_bleeders</span><span class='lparen'>(</span><span class='id identifier rubyid_health_lines'>health_lines</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_bleeders'>bleeders</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_bleeder_line_regex'>bleeder_line_regex</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^\b(inside\s+)?((l\.|r\.|left|right)\s+)?(head|eye|neck|chest|abdomen|back|arm|hand|leg|tail|skin)\b</span><span class='regexp_end'>/</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_health_lines'>health_lines</span><span class='period'>.</span><span class='id identifier rubyid_grep'>grep</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Bleeding|^\s*\bArea\s+Rate\b</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_health_lines'>health_lines</span>
      <span class='period'>.</span><span class='id identifier rubyid_drop_while'>drop_while</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_bleeder_line_regex'>bleeder_line_regex</span> <span class='op'>=~</span> <span class='id identifier rubyid_line'>line</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='period'>.</span><span class='id identifier rubyid_take_while'>take_while</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_bleeder_line_regex'>bleeder_line_regex</span> <span class='op'>=~</span> <span class='id identifier rubyid_line'>line</span> <span class='rbrace'>}</span>
      <span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
        <span class='comment'># Do regex then look for the body part match.
</span>        <span class='id identifier rubyid_line'>line</span> <span class='op'>=~</span> <span class='gvar'>$DRCH_WOUND_BODY_PART_REGEX</span>
        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='period'>.</span><span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:part</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>part</span><span class='tstring_end'>&#39;</span></span>
        <span class='comment'># Standardize on full word for &#39;left&#39; and &#39;right&#39;.
</span>        <span class='comment'># Internal bleeders use the abbreviations.
</span>        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>l.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>left</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>right</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='comment'># Check for the bleeding severity.
</span>        <span class='id identifier rubyid_bleed_rate'>bleed_rate</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(?:head|eye|neck|chest|abdomen|back|arm|hand|leg|tail|skin)\s+(.+)</span><span class='regexp_end'>/</span></span><span class='period'>.</span><span class='id identifier rubyid_match'><span class='object_link'><a href="../../top-level-namespace.html#match-instance_method" title="#match (method)">match</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='gvar'>$DRCH_BLEED_RATE_TO_SEVERITY_MAP</span><span class='lbracket'>[</span><span class='id identifier rubyid_bleed_rate'>bleed_rate</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:severity</span><span class='rbracket'>]</span>
        <span class='comment'># Check if internal or not. Want an actual boolean result here, not just &quot;truthy/falsey&quot;.
</span>        <span class='id identifier rubyid_is_internal'>is_internal</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^inside</span><span class='regexp_end'>/</span></span> <span class='op'>?</span> <span class='kw'>true</span> <span class='op'>:</span> <span class='kw'>false</span>
        <span class='id identifier rubyid_bleeders'>bleeders</span><span class='lbracket'>[</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='label'>body_part:</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span>
          <span class='label'>severity:</span> <span class='id identifier rubyid_severity'>severity</span><span class='comma'>,</span>
          <span class='label'>bleeding_rate:</span> <span class='id identifier rubyid_bleed_rate'>bleed_rate</span><span class='comma'>,</span>
          <span class='label'>is_internal:</span> <span class='id identifier rubyid_is_internal'>is_internal</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_bleeders'>bleeders</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_lodged_items-class_method">
  
    .<strong>parse_lodged_items</strong>(lodged_line)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given the line of text from the HEALTH command output that expresses items lodged into you, returns a map of any lodged items where the keys are the severity and the values are the list of wounds. Given the line of text from the HEALTH command output that expresses items lodged into you, returns a map of any lodged items where the keys are the severity and the values are the list of wounds.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_lodged_items'>lodged_items</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_lodged_items'>parse_lodged_items</span><span class='lparen'>(</span><span class='id identifier rubyid_lodged_line'>lodged_line</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>lodged_line</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The line containing lodged item descriptions</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing lodged items categorized by severity</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 354</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_lodged_items'>parse_lodged_items</span><span class='lparen'>(</span><span class='id identifier rubyid_lodged_line'>lodged_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_lodged_items'>lodged_items</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_lodged_line'>lodged_line</span>
    <span class='comment'># Remove the tidbits at the start and end of the sentence that aren&#39;t pertinent.
</span>    <span class='id identifier rubyid_lodged_line'>lodged_line</span> <span class='op'>=</span> <span class='id identifier rubyid_lodged_line'>lodged_line</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\.$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_lodged_line'>lodged_line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_wound'>wound</span><span class='op'>|</span>
      <span class='comment'># Do regex then look for the body part match.
</span>      <span class='id identifier rubyid_wound'>wound</span> <span class='op'>=~</span> <span class='gvar'>$DRCH_LODGED_BODY_PART_REGEX</span>
      <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='period'>.</span><span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:part</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>part</span><span class='tstring_end'>&#39;</span></span>
      <span class='comment'># Check for the lodged severity.
</span>      <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\blodged\s+(.*)\s+in(?:to)? your\b</span><span class='regexp_end'>/</span></span><span class='period'>.</span><span class='id identifier rubyid_match'><span class='object_link'><a href="../../top-level-namespace.html#match-instance_method" title="#match (method)">match</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wound'>wound</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='gvar'>$DRCH_LODGED_TO_SEVERITY_MAP</span><span class='lbracket'>[</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_lodged_items'>lodged_items</span><span class='lbracket'>[</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
        <span class='label'>body_part:</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span>
        <span class='label'>severity:</span> <span class='id identifier rubyid_severity'>severity</span><span class='comma'>,</span>
        <span class='label'>is_lodged_item:</span> <span class='kw'>true</span>
      <span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_lodged_items'>lodged_items</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_parasites-class_method">
  
    .<strong>parse_parasites</strong>(parasites_line)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given the line of text from the HEALTH command output that expresses parasites latched to you, returns a map of any parasites where the keys are the severity and the values are the list of wounds. Given the line of text from the HEALTH command output that expresses parasites latched to you, returns a map of any parasites where the keys are the severity and the values are the list of wounds.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_parasites'>parasites</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_parasites'>parse_parasites</span><span class='lparen'>(</span><span class='id identifier rubyid_parasites_line'>parasites_line</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>parasites_line</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The line containing parasite descriptions</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing parasites categorized by severity</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 322</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_parasites'>parse_parasites</span><span class='lparen'>(</span><span class='id identifier rubyid_parasites_line'>parasites_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parasites'>parasites</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_parasites_line'>parasites_line</span>
    <span class='comment'># Remove the tidbits at the start and end of the sentence that aren&#39;t pertinent.
</span>    <span class='id identifier rubyid_parasites_line'>parasites_line</span> <span class='op'>=</span> <span class='id identifier rubyid_parasites_line'>parasites_line</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\.$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_parasites_line'>parasites_line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_parasite'>parasite</span><span class='op'>|</span>
      <span class='comment'># Do regex then look for the body part match.
</span>      <span class='id identifier rubyid_parasite'>parasite</span> <span class='op'>=~</span> <span class='gvar'>$DRCH_PARASITE_BODY_PART_REGEX</span>
      <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:part</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_parasites'>parasites</span><span class='lbracket'>[</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
        <span class='label'>body_part:</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span>
        <span class='label'>severity:</span> <span class='id identifier rubyid_severity'>severity</span><span class='comma'>,</span>
        <span class='label'>is_parasite:</span> <span class='kw'>true</span>
      <span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_parasites'>parasites</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_perceived_health-class_method">
  
    .<strong>parse_perceived_health</strong>(target = nil)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Examples of what this parses can be found in test/test_check_health.rb Parses the perceived health data of a target.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_health_data'>health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_perceived_health'>parse_perceived_health</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The name of the target to perceive health, defaults to nil for self</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing perceived health data or nil if not found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 147</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_perceived_health'>parse_perceived_health</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_pause'><span class='object_link'><a href="../../top-level-namespace.html#pause-instance_method" title="#pause (method)">pause</a></span></span> <span class='float'>0.5</span> <span class='comment'># Pause to wait for the full response to come back from the server
</span>
  <span class='id identifier rubyid_stop_line'>stop_line</span> <span class='op'>=</span> <span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Your injuries include...</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>You sense a successful empathic link has been forged between you and </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_content'>\.</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_health_lines'>health_lines</span> <span class='op'>=</span> <span class='id identifier rubyid_reget'><span class='object_link'><a href="../../top-level-namespace.html#reget-instance_method" title="#reget (method)">reget</a></span></span><span class='lparen'>(</span><span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_health_lines'>health_lines</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_stop_line'>stop_line</span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_parasites_regex'>parasites_regex</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='gvar'>$DRCH_PARASITES_REGEX_LIST</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_poisons_regex'>poisons_regex</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='lbracket'>[</span>
                                 <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[\w]+ (?:has|have) a .* poison</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
                                 <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>having trouble breathing</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
                                 <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Cyanide poison</span><span class='regexp_end'>/</span></span>
                               <span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_diseases_regex'>diseases_regex</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='lbracket'>[</span>
                                  <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[\w]+ wounds are (badly )?infected</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
                                  <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[\w]+ (?:has|have) a dormant infection</span><span class='regexp_end'>/</span></span><span class='comma'>,</span>
                                  <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^[\w]+ (?:body|skin) is covered (?:in|with) open oozing sores</span><span class='regexp_end'>/</span></span>
                                <span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_dead_regex'>dead_regex</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='lbracket'>[</span>
                              <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(He|She) is dead</span><span class='regexp_end'>/</span></span>
                            <span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_perceived_wounds'>perceived_wounds</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_perceived_parasites'>perceived_parasites</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_perceived_poison'>perceived_poison</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_perceived_disease'>perceived_disease</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_wound_body_part'>wound_body_part</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_dead'>dead</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='id identifier rubyid_health_lines'>health_lines</span>
    <span class='period'>.</span><span class='id identifier rubyid_take_while'>take_while</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span> <span class='id identifier rubyid_line'>line</span> <span class='op'>!=</span> <span class='id identifier rubyid_stop_line'>stop_line</span> <span class='rbrace'>}</span>
    <span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span> <span class='comment'># put back in normal order so we parse &lt;body part&gt; line then &lt;wound&gt; lines
</span>    <span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_line'>line</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_dead_regex'>dead_regex</span>
        <span class='id identifier rubyid_dead'>dead</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_diseases_regex'>diseases_regex</span>
        <span class='id identifier rubyid_perceived_disease'>perceived_disease</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_poisons_regex'>poisons_regex</span>
        <span class='id identifier rubyid_perceived_poison'>perceived_poison</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>when</span> <span class='id identifier rubyid_parasites_regex'>parasites_regex</span>
        <span class='id identifier rubyid_line'>line</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.* on (?:his|her|your) (?&lt;body_part&gt;[\w\s]*)</span><span class='regexp_end'>/</span></span>
        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_perceived_parasites'>perceived_parasites</span><span class='lbracket'>[</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='label'>body_part:</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span>
          <span class='label'>severity:</span> <span class='id identifier rubyid_severity'>severity</span>
        <span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^Wounds to the (.+):</span><span class='regexp_end'>/</span></span>
        <span class='id identifier rubyid_wound_body_part'>wound_body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_perceived_wounds'>perceived_wounds</span><span class='lbracket'>[</span><span class='id identifier rubyid_wound_body_part'>wound_body_part</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(Fresh|Scars) (External|Internal)</span><span class='regexp_end'>/</span></span>
        <span class='comment'># Do regex then grab matches for wound details.
</span>        <span class='id identifier rubyid_line'>line</span> <span class='op'>=~</span> <span class='gvar'>$DRCH_PERCEIVE_HEALTH_SEVERITY_REGEX</span>
        <span class='id identifier rubyid_severity'>severity</span> <span class='op'>=</span> <span class='gvar'>$DRCH_WOUND_TO_SEVERITY_MAP</span><span class='lbracket'>[</span><span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:severity</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_is_internal'>is_internal</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:location</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Internal</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_is_scar'>is_scar</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:freshness</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Scars</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_perceived_wounds'>perceived_wounds</span><span class='lbracket'>[</span><span class='id identifier rubyid_body_part'>body_part</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='label'>body_part:</span> <span class='id identifier rubyid_wound_body_part'>wound_body_part</span><span class='comma'>,</span>
          <span class='label'>severity:</span> <span class='id identifier rubyid_severity'>severity</span><span class='comma'>,</span>
          <span class='label'>is_internal:</span> <span class='id identifier rubyid_is_internal'>is_internal</span><span class='comma'>,</span>
          <span class='label'>is_scar:</span> <span class='id identifier rubyid_is_scar'>is_scar</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='comment'># Now go through the preceived wounds map (key=body part)
</span>  <span class='comment'># and bucket the wounds by severity into the &#39;wounds&#39; map (key=severity).
</span>  <span class='id identifier rubyid_wounds'>wounds</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_perceived_wounds'>perceived_wounds</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_wound'>wound</span><span class='op'>|</span>
    <span class='id identifier rubyid_wounds'>wounds</span><span class='lbracket'>[</span><span class='id identifier rubyid_wound'>wound</span><span class='period'>.</span><span class='id identifier rubyid_severity'>severity</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_wound'>wound</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wounds</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>parasites</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_perceived_parasites'>perceived_parasites</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>poisoned</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_perceived_poison'>perceived_poison</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>diseased</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_perceived_disease'>perceived_disease</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dead</span><span class='tstring_end'>&#39;</span></span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_dead'>dead</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_calculate_score'>calculate_score</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds'>wounds</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_wounds-class_method">
  
    .<strong>parse_wounds</strong>(wounds_line)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Given the line of text from the HEALTH command output that expresses external and internal wounds and scars, returns a map of any wounds where the keys are the severity and the values are the list of wounds. Given the line of text from the HEALTH command output that expresses external and internal wounds and scars, returns a map of any wounds where the keys are the severity and the values are the list of wounds.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_wounds'>wounds</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_wounds'>parse_wounds</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>wounds_line</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The line containing wound descriptions</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing wounds categorized by severity</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 286</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_wounds'>parse_wounds</span><span class='lparen'>(</span><span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wounds'>wounds</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span> <span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_wounds_line'>wounds_line</span>
    <span class='comment'># Remove commas within wound text so we can split on each wound phrase.
</span>    <span class='comment'># For example &quot;a bruised, swollen and slashed left eye&quot; =&gt; &quot;a bruised swollen and slashed left eye&quot;
</span>    <span class='id identifier rubyid_wounds_line'>wounds_line</span> <span class='op'>=</span> <span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='gvar'>$DRCH_WOUND_COMMA_SEPARATOR</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='comment'># Remove the tidbits at the start and end of the sentence that aren&#39;t pertinent.
</span>    <span class='id identifier rubyid_wounds_line'>wounds_line</span> <span class='op'>=</span> <span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You have\s+</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\.$</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_wounds_line'>wounds_line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:strip</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_wound'>wound</span><span class='op'>|</span>
      <span class='gvar'>$DRCH_WOUND_SEVERITY_REGEX_MAP</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_regex'>regex</span><span class='comma'>,</span> <span class='id identifier rubyid_template'>template</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_wound'>wound</span> <span class='op'>=~</span> <span class='id identifier rubyid_regex'>regex</span>

        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='period'>.</span><span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:part</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_body_part'>body_part</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>part</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_wounds'>wounds</span><span class='lbracket'>[</span><span class='id identifier rubyid_template'>template</span><span class='lbracket'>[</span><span class='symbol'>:severity</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="DRCH/Wound.html" title="Lich::DragonRealms::DRCH::Wound (class)">Wound</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DRCH/Wound.html#initialize-instance_method" title="Lich::DragonRealms::DRCH::Wound#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='label'>body_part:</span> <span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span>
          <span class='label'>severity:</span> <span class='id identifier rubyid_template'>template</span><span class='lbracket'>[</span><span class='symbol'>:severity</span><span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='label'>is_internal:</span> <span class='id identifier rubyid_template'>template</span><span class='lbracket'>[</span><span class='symbol'>:internal</span><span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='label'>is_scar:</span> <span class='id identifier rubyid_template'>template</span><span class='lbracket'>[</span><span class='symbol'>:scar</span><span class='rbracket'>]</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_wounds'>wounds</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="perceive_health-class_method">
  
    .<strong>perceive_health</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Uses PERCEIVE HEALTH SELF command to check for wounds and scars. Returns a map of any wounds where the keys are the severity and the values are the list of wounds. Uses PERCEIVE HEALTH SELF command to check for wounds and scars. Returns a map of any wounds where the keys are the severity and the values are the list of wounds.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_perceived_health_data'>perceived_health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_perceive_health'>perceive_health</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing perceived health data including wounds and score</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_perceive_health'>perceive_health</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="DRStats.html" title="Lich::DragonRealms::DRStats (module)">DRStats</a></span></span><span class='period'>.</span><span class='id identifier rubyid_empath?'><span class='object_link'><a href="DRStats.html#empath%3F-class_method" title="Lich::DragonRealms::DRStats.empath? (method)">empath?</a></span></span>

  <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>perceive health self</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>feel only an aching emptiness</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Roundtime</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>feel only an aching emptiness</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># Empath is permashocked and cannot perceive wounds.
</span>    <span class='kw'>return</span> <span class='id identifier rubyid_check_health'>check_health</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_perceived_health_data'>perceived_health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_perceived_health'>parse_perceived_health</span>

  <span class='comment'># Return same response as `check_health` but with wound details per perceive health.
</span>  <span class='id identifier rubyid_health_data'>health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_check_health'>check_health</span>
  <span class='id identifier rubyid_health_data'>health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wounds</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_perceived_health_data'>perceived_health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wounds</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_health_data'>health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_perceived_health_data'>perceived_health_data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>score</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># The `perceive health self` command incurs roundtime. We delayed waiting until now so that
</span>  <span class='comment'># the script can use that time to parse the output rather than waiting unnecessarily.
</span>  <span class='id identifier rubyid_waitrt?'><span class='object_link'><a href="../../top-level-namespace.html#waitrt%3F-instance_method" title="#waitrt? (method)">waitrt?</a></span></span>
  <span class='kw'>return</span> <span class='id identifier rubyid_health_data'>health_data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="perceive_health_other-class_method">
  
    .<strong>perceive_health_other</strong>(target)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks the health of another target using empathic abilities.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_health_data'>health_data</span> <span class='op'>=</span> <span class='id identifier rubyid_perceive_health_other'>perceive_health_other</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>John</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>target</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of the target to perceive health</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing perceived health data or nil if unable to perceive</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_perceive_health_other'>perceive_health_other</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="DRStats.html" title="Lich::DragonRealms::DRStats (module)">DRStats</a></span></span><span class='period'>.</span><span class='id identifier rubyid_empath?'><span class='object_link'><a href="DRStats.html#empath%3F-class_method" title="Lich::DragonRealms::DRStats.empath? (method)">empath?</a></span></span>

  <span class='kw'>case</span> <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>touch </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_target'>target</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Touch what</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>feels cold and you are unable to sense anything</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>avoids your touch</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You sense a successful empathic link has been forged between you and (?&lt;name&gt;\w+)\.</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You quickly recoil</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
  <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>avoids your touch</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>feels cold and you are unable to sense anything</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Touch what</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^You quickly recoil</span><span class='regexp_end'>/</span></span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>when</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>You sense a successful empathic link has been forged between you and (?&lt;name&gt;\w+)\.</span><span class='regexp_end'>/</span></span>
    <span class='comment'># The target passed to the method might be abbreviated
</span>    <span class='comment'># or not match the exact casing as the person&#39;s actual name.
</span>    <span class='comment'># Since this value becomes part of regex patterns later,
</span>    <span class='comment'># make sure we&#39;re using the actual character&#39;s name.
</span>    <span class='id identifier rubyid_target'>target</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_parse_perceived_health'>parse_perceived_health</span><span class='lparen'>(</span><span class='id identifier rubyid_target'>target</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="skilled_to_tend_wound?-class_method">
  
    .<strong>skilled_to_tend_wound?</strong>(bleed_rate, internal = false)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Skill check to tend a bleeding wound. If you’re not skilled enough you may make things worse and incur long roundtime. Skill check to tend a bleeding wound. If you’re not skilled enough you may make things worse and incur long roundtime.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_is_skilled'>is_skilled</span> <span class='op'>=</span> <span class='id identifier rubyid_skilled_to_tend_wound?'>skilled_to_tend_wound?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>light</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>bleed_rate</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The rate of bleeding</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>internal</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Whether the wound is internal, defaults to false</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if skilled enough to tend the wound, false otherwise</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


438
439
440
441
442
443
444</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 438</span>

<span class='kw'>def</span> <span class='id identifier rubyid_skilled_to_tend_wound?'>skilled_to_tend_wound?</span><span class='lparen'>(</span><span class='id identifier rubyid_bleed_rate'>bleed_rate</span><span class='comma'>,</span> <span class='id identifier rubyid_internal'>internal</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_skill_target'>skill_target</span> <span class='op'>=</span> <span class='id identifier rubyid_internal'>internal</span> <span class='op'>?</span> <span class='symbol'>:skill_to_tend_internal</span> <span class='op'>:</span> <span class='symbol'>:skill_to_tend</span>
  <span class='id identifier rubyid_min_skill'>min_skill</span> <span class='op'>=</span> <span class='gvar'>$DRCH_BLEED_RATE_TO_SEVERITY_MAP</span><span class='lbracket'>[</span><span class='id identifier rubyid_bleed_rate'>bleed_rate</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_skill_target'>skill_target</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_min_skill'>min_skill</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='const'><span class='object_link'><a href="DRSkill.html" title="Lich::DragonRealms::DRSkill (class)">DRSkill</a></span></span><span class='period'>.</span><span class='id identifier rubyid_getrank'><span class='object_link'><a href="DRSkill.html#getrank-class_method" title="Lich::DragonRealms::DRSkill.getrank (method)">getrank</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>First Aid</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_min_skill'>min_skill</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unwrap_wound-class_method">
  
    .<strong>unwrap_wound</strong>(body_part, person = &#39;my&#39;)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Unwraps the bandages from a specified wound.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_unwrap_wound'>unwrap_wound</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>left arm</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>body_part</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The body part to unwrap</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>person</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;my&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The person to unwrap, defaults to ‘my’</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


424
425
426
427</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/dragonrealms/commons/common-healing.rb', line 424</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unwrap_wound'>unwrap_wound</span><span class='lparen'>(</span><span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span> <span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="DRC.html" title="Lich::DragonRealms::DRC (module)">DRC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_bput'><span class='object_link'><a href="DRC.html#bput-class_method" title="Lich::DragonRealms::DRC.bput (method)">bput</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unwrap </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_person'>person</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_body_part'>body_part</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You unwrap .* bandages</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>That area is not tended</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You may undo the affects of TENDing</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_waitrt?'><span class='object_link'><a href="../../top-level-namespace.html#waitrt%3F-instance_method" title="#waitrt? (method)">waitrt?</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Nov  7 08:04:20 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.2.9).
</div>

    </div>
  </body>
</html>